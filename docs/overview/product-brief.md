---
name: "docs/requirements/01_product_brief.md"
title: "プロダクト概要と基本要件定義 (Product Brief)"
description: "コミットコーチ - プロダクトの概要、目標、ターゲットユーザー、主要機能、基本要件などを定義します。"
version: "1.1"
last_updated: "YYYY-MM-DD" # 更新日を記述
---

# コミットコーチ - プロダクト概要と基本要件定義

## 0. 改訂履歴

| バージョン | 更新日     | 更新者   | 更新内容                                   |
| :--------- | :--------- | :------- | :----------------------------------------- |
| 1.0        | YYYY-MM-DD | [担当者名] | 初版作成                                   |
| 1.1        | YYYY-MM-DD | [担当者名] | 各セクションの詳細化、非機能要件の追加など |

## 1. はじめに

### 1.1 背景と目的

開発現場において、タスク管理の複雑化や先延ばしは生産性を低下させる大きな要因です。特に個人開発者や小規模チームでは、体系的な管理手法やモチベーション維持が課題となることがあります。
**コミットコーチ**は、直感的なタスク管理インターフェースとAIによるパーソナルコーチングを組み合わせることで、これらの課題を解決し、開発者の生産性向上と目標達成を支援することを目的とします。

本ドキュメントは、コミットコーチの初期開発（MVP: Minimum Viable Product）におけるプロダクト概要と基本要件を定義するものです。

### 1.2 プロダクト概要

**コミットコーチ** は、開発者がタスクを効率的に管理し、先延ばしを防止するために設計されたWebアプリケーションです。Trello風のカンバンボードによる視覚的なタスク管理機能と、ユーザーの進捗状況に合わせてパーソナライズされたアドバイスを提供するAIコーチング機能をコアとし、開発者の日々のコミットメント達成をサポートします。

**初期開発目標**: Next.js, React, TypeScript, Tailwind CSS を用いて、2ヶ月以内にMVPを構築し、開発者向けに公開します。MVPではコア機能に集中し、GitHub連携などの高度な機能は将来的な拡張とします。

### 1.3 用語集

| 用語             | 説明                                                                 |
| :--------------- | :------------------------------------------------------------------- |
| **プロジェクト** | ユーザーが管理する作業のまとまり。複数のタスクグループを含む。         |
| **タスクグループ** | プロジェクト内でタスクを分類する単位（例：機能別、ステータス別）。     |
| **タスク**       | 実行すべき具体的な作業項目。サブタスクを持つことができる。             |
| **サブタスク**   | タスクをさらに細分化した作業項目。                                   |
| **AIコーチ**     | ユーザーのタスク進捗や状況に応じてアドバイスや励ましを行うAI機能。     |
| **カンバンボード** | タスクをカード形式で表示し、ステータスごとにレーンを分けて管理するUI。 |
| **MVP**          | Minimum Viable Product。実用最小限の製品。                           |
| **MAU**          | Monthly Active Users。月間アクティブユーザー数。                     |

## 2. アプリケーション要件

### 2.1 基本情報

-   **アプリ名**: コミットコーチ (Commit Coach)
-   **概要**: 開発者の先延ばし習慣をAIコーチングとタスク可視化で解決するタスク管理アプリ
-   **ターゲットユーザー**:
    -   **開発者**:
        -   課題: タスク管理が苦手、締め切り直前に慌てる、モチベーション維持が難しい
        -   解決策: 直感的なタスク管理、AIによる進捗サポートとコーチング
    -   **プロジェクトマネージャー (小規模チーム)**:
        -   課題: チーム/個人の進捗把握が難しい
        -   解決策: プロジェクト全体のタスク可視化、進捗状況の共有（将来拡張）
-   **提供価値**:
    1.  **先延ばし防止**: AIコーチングによる計画的なタスク遂行支援とモチベーション維持
    2.  **生産性向上**: タスクの階層化と可視化による効率的な作業管理と進捗把握
    3.  **見通しの確保**: 期限管理とタイムライン表示による計画的な作業遂行
-   **ビジネスゴール**: 開発者向けSaaSとして月間アクティブユーザー1万人獲得（フリーミアムモデルを想定）
-   **成功指標 (KPI)**:
    -   MAU (Monthly Active Users)
    -   タスク完了率
    -   ユーザー継続率 (Retention Rate)
    -   NPS (Net Promoter Score)

### 2.2 スコープ

#### 2.2.1 MVP開発対象 (In Scope)

-   **ユーザー認証**:
    -   メールアドレス・パスワードによるサインアップ、ログイン、ログアウト
    -   パスワードリセット機能（基本的なもの）
-   **プロジェクト管理**:
    -   プロジェクトの作成、編集、削除
    -   プロジェクト一覧表示
-   **タスク管理 (階層構造)**:
    -   タスクグループの作成、編集、削除、並び替え (D&D)
    -   タスクの作成、編集、削除、並び替え (D&D)
    -   サブタスクの作成、編集、削除
    -   タスク/サブタスクの完了状態管理 (チェックボックス)
    -   タスク/タスクグループの展開・折りたたみ
    -   タスク/タスクグループへの期限設定 (日付・時刻)
    -   期限切れタスクの視覚的警告
-   **ダッシュボード**:
    -   今日のタスク一覧表示 (時間指定タスク)
    -   未定タスク一覧表示
    -   現在時刻表示
-   **AIコーチング (基本)**:
    -   AIチャットインターフェース
    -   固定的な応答パターンに基づく基本的なアドバイス・励まし
    -   タスク分解の提案 (手動トリガー)
-   **マイページ/設定**:
    -   ユーザーアカウント情報表示
    -   基本的なアプリ設定（テーマ切り替えなど）

#### 2.2.2 MVP開発対象外 (Out of Scope)

-   GitHub API連携 (コミット履歴取得、Issue連携など)
-   チーム機能 (複数ユーザーでのプロジェクト共有、権限管理など)
-   高度なAIコーチング (ユーザー行動分析に基づくパーソナライズ、予測など)
-   モバイルアプリケーション (iOS/Android)
-   外部カレンダー連携 (Google Calendar, Outlook Calendar)
-   高度なレポート・分析機能
-   通知機能 (プッシュ通知、メール通知)
-   ファイル添付機能
-   タグ付け、フィルタリング機能 (高度なもの)
-   音声入力

## 3. 機能要件

### 3.1 コア機能

| 機能 ID | 機能名           | 説明                                                                                                                               | 対応ユーザー課題                             | 優先度 |
| :------ | :--------------- | :--------------------------------------------------------------------------------------------------------------------------------- | :------------------------------------------- | :----- |
| F001    | タスク管理       | プロジェクト > タスクグループ > タスク > サブタスク の階層構造でタスクを視覚的に管理。ドラッグ＆ドロップで並び替えやステータス変更が可能。 | タスクの優先順位付けと進捗管理の難しさ       | P0     |
| F002    | AIコーチング     | AIアシスタントとの対話を通じて、タスク完了を促すアドバイスや励ましを提供。タスク分解のヒントも提示。                                   | モチベーション維持と先延ばし防止             | P1     |
| F003    | プロジェクト管理 | 複数のプロジェクトを作成・管理し、それぞれの進捗状況を一覧で把握。                                                                 | プロジェクト全体の進捗把握の難しさ           | P0     |
| F004    | 期限管理         | タスク、タスクグループに期限（日付・時刻）を設定し、カレンダーやリストで表示。期限切れや間近なタスクを警告。                             | 締め切り管理の難しさ、作業の見通し確保       | P1     |
| F005    | ダッシュボード   | 「今日のタスク」と「未定のタスク」を集約表示し、日々の作業計画を支援。現在時刻も表示。                                               | 日々の作業計画立案、集中すべきタスクの明確化 | P0     |
| F006    | ユーザー認証     | 安全なユーザー登録、ログイン、ログアウト機能を提供。                                                                               | アプリケーションへのアクセス制御             | P0     |
| F007    | マイページ/設定  | ユーザー情報の確認や基本的なアプリ設定（AIコーチの応答スタイル選択など）を行う。                                                     | 個人設定の管理                               | P1     |

*(優先度: P0: Must Have, P1: Should Have, P2: Could Have, P3: Won't Have (MVP))*

### 3.2 画面要件

#### 3.2.1 画面一覧

-   ランディングページ (`/`)
-   サインアップ画面 (`/register`)
-   ログイン画面 (`/login`)
-   パスワードリセット要求画面 (`/password/reset`)
-   パスワードリセット実行画面 (`/password/update`)
-   ダッシュボード画面 (`/dashboard`)
-   プロジェクト画面 (`/projects/[projectId]`)
-   マイページ画面 (`/mypage`)
-   設定画面 (`/settings`)

#### 3.2.2 主要画面詳細

1.  **ダッシュボード (`/dashboard`)**
    *   目的: ユーザーがその日に集中すべきタスクと未スケジュールタスクを把握し、AIコーチングを受ける。
    *   主要表示項目:
        *   現在時刻、日付
        *   今日のタスクリスト（時間順）
        *   未定のタスクリスト
        *   AIコーチングチャットウィンドウ
    *   主要操作:
        *   タスクの完了/未完了切り替え
        *   タスクの展開/折りたたみ
        *   タスクのドラッグ＆ドロップによる時間変更/未定への移動
        *   未定タスクの今日への移動
        *   AIへのメッセージ送信
2.  **プロジェクト画面 (`/projects/[projectId]`)**
    *   目的: 特定のプロジェクトに属するタスクを階層的に管理する。
    *   主要表示項目:
        *   プロジェクトタイトル、プロジェクト期限
        *   タスクグループリスト（D&D可能）
        *   各タスクグループ内のタスクリスト（D&D可能）
        *   各タスク内のサブタスクリスト
        *   AIコーチングチャットウィンドウ
    *   主要操作:
        *   プロジェクト/タスクグループ/タスク/サブタスクのCRUD操作
        *   タスク/サブタスクの完了/未完了切り替え
        *   タスク/タスクグループの展開/折りたたみ
        *   タスク/タスクグループの期限設定
        *   タスク/タスクグループのD&Dによる並び替え、グループ間移動
        *   AIへのメッセージ送信
3.  **マイページ (`/mypage`)**
    *   目的: ユーザーが自身のアカウント情報を確認・編集する。
    *   主要表示項目:
        *   ユーザー名、メールアドレス
        *   アバター画像（プレースホルダー可）
    *   主要操作:
        *   アカウント名、メールアドレス、パスワードの変更フォーム表示
        *   （将来）外部サービス連携設定
4.  **設定画面 (`/settings`)**
    *   目的: アプリケーション全体の動作やAIコーチの設定を行う。
    *   主要表示項目:
        *   AIコーチ設定（応答スタイル選択など）
        *   通知設定（MVPでは表示のみ）
        *   テーマ設定（ライト/ダーク）
    *   主要操作:
        *   設定項目の変更と保存

### 3.3 UI/UX要件

-   **デザインコンセプト**:
    -   シンプルで直感的: 複雑な操作を避け、学習コストを低くする。
    -   モチベーションを高める: 進捗の可視化、達成感の演出、AIによるポジティブなフィードバック。
    -   集中をサポート: ノイズを減らし、タスク遂行に必要な情報にフォーカスできるデザイン。
-   **デザイン原則**:
    -   配色:
        -   ベースカラー: ホワイト系 (#FFFFFF, #F9FAFB, #F3F4F6, #E5E7EB) - クリーンさ、読みやすさ
        -   アクセントカラー: ティール (#31A9B8) - 信頼感、モチベーション、主要アクション
        -   テキストカラー: ダークグレー (#111827) - 高い可読性
        -   警告/期限切れ: 赤系 (#CF3721)
        -   注意/期限間近: 黄色系 (#F5BE41)
        -   完了: 緑系 (#258039)
    -   フォント:
        -   見出し: システムフォント Bold - 視認性、階層表現
        -   本文: システムフォント Regular - 読みやすさ、一貫性
    -   レイアウト:
        -   主要画面はサイドバー + メインコンテンツ (+ 右ペインのAIチャット) の構成。
        -   十分な余白を取り、情報を整理。
-   **レスポンシブ対応**:
    -   デスクトップ、タブレット、モバイルデバイスで適切に表示・操作できること。
    -   モバイルではサイドバーはデフォルトで非表示、ハンバーガーメニュー等で開閉可能とする。
-   **インタラクション**:
    -   ドラッグ＆ドロップ操作は視覚的に分かりやすく、スムーズに行えること。
    -   状態変更（完了、展開など）は即座にUIに反映されること。
    -   ホバーエフェクトやクリックフィードバックを適切に実装する。
-   **アクセシビリティ (目標: WCAG 2.1 AA準拠)**:
    -   キーボード操作のみで主要機能が利用可能であること。
    -   適切なコントラスト比を確保すること。
    -   スクリーンリーダーで適切に読み上げられるように、適切なHTMLセマンティクスとARIA属性を使用すること。
    -   フォーカスインジケーターを明確に表示すること。

### 3.4 データ要件 (データモデル概要)

-   **ユーザー (User)**: id, email, password_hash, name, created_at, updated_at
-   **プロジェクト (Project)**: id, user_id, title, color, due_date, completed, created_at, updated_at
-   **タスクグループ (TaskGroup)**: id, project_id, title, expanded, due_date, completed, order, created_at, updated_at
-   **タスク (Task)**: id, task_group_id, title, completed, expanded, due_date, order, created_at, updated_at
-   **サブタスク (SubTask)**: id, task_id, title, completed, order, created_at, updated_at
-   **AIチャットメッセージ (AIChatMessage)**: id, user_id, role (user/assistant), content, timestamp

*(詳細は別途データモデル定義書で規定)*

## 4. 非機能要件

### 4.1 性能要件

-   **レスポンスタイム**:
    -   主要画面遷移: 1秒以内
    -   タスク操作（CRUD、D&D）のUI反映: 500ms以内
    -   AI応答時間（基本応答）: 3秒以内
-   **同時接続数**: MVP段階では 500ユーザー程度を想定。

### 4.2 セキュリティ要件

-   **認証**: JWT (JSON Web Token) を用いたセッション管理。
-   **認可**: ユーザーは自身のデータのみアクセス可能。
-   **パスワード**: bcrypt等によるハッシュ化とソルトを用いて安全に保存。
-   **通信**: 全ての通信はHTTPSを使用。
-   **脆弱性対策**:
    -   XSS (Cross-Site Scripting) 対策: 適切なエスケープ処理。
    -   CSRF (Cross-Site Request Forgery) 対策: トークン検証。
    -   SQLインジェクション対策 (Supabase利用により軽減されるが、API実装時に注意)。
-   **依存ライブラリ**: 定期的な脆弱性スキャンとアップデート。

### 4.3 可用性要件

-   **サービス稼働率**: MVP段階ではベストエフォート。目標 99.5% (Vercel/SupabaseのSLAに依存)。
-   **バックアップ**: Supabaseの自動バックアップ機能を利用。
-   **障害復旧**: Vercel/Supabaseの障害復旧プロセスに依存。

### 4.4 技術スタック

-   **フロントエンド**:
    -   フレームワーク: Next.js (App Router)
    -   言語: TypeScript
    -   UIライブラリ: React
    -   スタイリング: Tailwind CSS
    -   UIコンポーネント: shadcn/ui
    -   状態管理: React Context API / Zustand (必要に応じて)
    -   データフェッチ: SWR / React Query (必要に応じて)
    -   D&D: react-beautiful-dnd
    -   日付処理: date-fns
    -   アイコン: lucide-react
-   **バックエンド**:
    -   プラットフォーム: Supabase (BaaS)
    -   データベース: PostgreSQL (Supabase提供)
    -   認証: Supabase Auth
    -   API: Next.js API Routes (必要に応じて) / Supabase Functions (必要に応じて)
-   **AI/ML**:
    -   基盤モデル: OpenAI API (GPT-3.5/GPT-4)
    -   SDK: AI SDK (Vercel)
-   **インフラ**:
    -   ホスティング (フロントエンド): Vercel
    -   ホスティング (バックエンド): Supabase
-   **開発ツール**:
    -   バージョン管理: Git / GitHub
    -   パッケージ管理: pnpm
    -   リンター/フォーマッター: ESLint / Prettier
    -   エディタ: Cursor (AI支援)

### 4.5 拡張性要件

-   将来的な機能追加（GitHub連携、チーム機能など）を考慮し、コンポーネントは疎結合に設計する。
-   Supabaseの機能を活用し、スケーラビリティを確保する。

### 4.6 保守性要件

-   コードはリーダブルで、一貫したコーディング規約に従う (ESLint/Prettierで強制)。
-   コンポーネントや主要な関数には適切なコメント (JSDoc) を付与する。
-   意味のあるコミットメッセージを記述する (Conventional Commits)。
-   依存ライブラリは適切に管理し、定期的にアップデートする。

### 4.7 運用要件

-   デプロイはVercelへのプッシュで自動化する。
-   基本的なログ監視 (Vercel/Supabaseの機能を利用)。

## 5. 開発計画

### 5.1 マイルストーン

| フェーズ     | 期間  | 主要な成果物                                                               |
| :----------- | :---- | :------------------------------------------------------------------------- |
| **フェーズ1: 設計** | 2週間 | 本要件定義書確定、ワイヤーフレーム、基本UIデザイン、技術調査             |
| **フェーズ2: 開発** | 6週間 | コア機能実装 (認証, プロジェクト管理, タスク管理, ダッシュボード, 基本AI) |
| **フェーズ3: テスト** | 2週間 | 内部テスト、ユーザーテスト (限定的)、バグ修正                             |
| **フェーズ4: リリース** | -     | Vercel/Supabaseへのデプロイ、初期リリース                                |

### 5.2 リスク管理

| リスク ID | リスク内容                     | 発生確率 | 影響度 | 対応策                                                                 |
| :-------- | :----------------------------- | :------- | :----- | :--------------------------------------------------------------------- |
| R001      | AIコーチング機能の精度が低い   | 中       | 中     | プロンプトエンジニアリングの最適化、固定応答パターン中心で開始           |
| R002      | 開発スケジュール遅延           | 中       | 高     | スコープ管理の徹底、優先度の高い機能から段階的に実装、バッファの確保   |
| R003      | Supabase利用上の技術的課題発生 | 低       | 中     | 事前調査、ドキュメント熟読、コミュニティ活用、代替案の検討             |
| R004      | UI/UXがターゲットに合わない    | 中       | 高     | 早期のワイヤーフレームレビュー、開発中のフィードバック収集、テスト実施 |
| R005      | セキュリティ脆弱性の発生       | 低       | 高     | セキュアコーディングの徹底、ライブラリの脆弱性管理、専門家レビュー（検討） |

## 6. UI/UX デザイン (概要)

### 6.1 デザインコンセプト

(2.3 UI/UX要件のデザインコンセプトを参照)

### 6.2 配色

(2.3 UI/UX要件のデザイン原則を参照)

### 6.3 フォント

(2.3 UI/UX要件のデザイン原則を参照)

### 6.4 ワイヤーフレーム/モックアップ

*(別途作成されるワイヤーフレーム/モックアップへのリンクを記載)*
例: [Figmaワイヤーフレームへのリンク](...)

## 7. 付録

### 7.1 参考資料

-   [Vercel AI SDK ドキュメント](...)
-   [Supabase ドキュメント](...)
-   [shadcn/ui ドキュメント](...)
-   [react-beautiful-dnd ドキュメント](...)
-   競合調査資料 (別途添付)

### 7.2 画面構成図 (簡易)

```mermaid
graph TD
    A[ランディングページ] --> B(サインアップ);
    A --> C(ログイン);
    C --> D{ダッシュボード};
    B --> D;
    D --> E[プロジェクト画面];
    D --> F[マイページ];
    D --> G[設定画面];
    E --> D;
    F --> D;
    G --> D;
    C --> H(パスワードリセット要求);
    H --> I(パスワードリセット実行);
    I --> C;











```markdown
---
name: "docs/overview_0/backend-structure.md"
title: "バックエンド ディレクトリ構造要件 (Backend Directory Structure)"
description: "Supabase を利用したバックエンドのディレクトリ構成と各要件の定義"
---

# バックエンド ディレクトリ構造要件

本ドキュメントでは、**コミットコーチ** のバックエンド (`backend/`) におけるディレクトリ構成要件を定義します。  
データベースには Supabase（PostgreSQL＋Auth＋リアルタイム機能）を採用する前提で設計しています。

---

## 1. ルート構成

```
[ProjectRoot]/
└── backend/
    ├── .env.example
    ├── Dockerfile
    ├── docker-compose.yml     # (任意) ローカル開発用
    ├── package.json
    ├── pnpm-lock.yaml
    ├── tsconfig.json
    ├── src/
    └── tests/
```

- **`.env.example`**  
  - SUPABASE_URL, SUPABASE_ANON_KEY, JWT_SECRET など、Supabase 接続・認証情報のサンプル。
- **`Dockerfile` / `docker-compose.yml`**  
  - Node.js コンテナ化およびローカルで Supabase エミュレータ起動用設定。
- **`package.json`**  
  - 依存パッケージ管理（`@supabase/supabase-js`、`express`、`zod` など）。
- **`tsconfig.json`**  
  - TypeScript コンパイラオプション。
- **`tests/`**  
  - 単体テスト・結合テスト配置。

---

## 2. `src/` 以下構成

```
src/
├── config/           ← 環境変数・アプリ設定読み込み
├── db/               ← Supabase クライアント初期化
├── middlewares/      ← 認証・エラーハンドリング等
├── models/           ← Zod スキーマ定義 (DTO・バリデーション)
├── controllers/      ← API エンドポイントハンドラ
├── routes/           ← Express ルーティング定義
├── services/         ← ビジネスロジック層（Supabase 操作含む）
├── utils/            ← 汎用ユーティリティ関数
├── types/            ← 共通型定義 (TypeScript インターフェース)
├── app.ts            ← Express アプリセットアップ
└── server.ts         ← サーバ起動・Supabase 認証ミドルウェア適用
```

### 2.1 `src/config/`

- **役割**  
  - `.env` から読み込む各種設定値をまとめてエクスポート。
- **ファイル例**  
  - `env.ts` — `process.env.SUPABASE_URL` などを型付きで提供。

### 2.2 `src/db/`

- **役割**  
  - `@supabase/supabase-js` クライアントの生成と再利用。
- **ファイル例**  
  ```ts
  // src/db/supabaseClient.ts
  import { createClient } from '@supabase/supabase-js';
  import { SUPABASE_URL, SUPABASE_ANON_KEY } from '../config/env';

  export const supabase = createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
  ```

### 2.3 `src/middlewares/`

- **役割**  
  - JWT 認証ミドルウェア、エラー処理、リクエストロガーなど。
- **ファイル例**  
  - `authMiddleware.ts` — `supabase.auth.getUser()` を利用した認証チェック。  
  - `errorHandler.ts` — 全 API のエラーをキャッチし統一レスポンスを返却。

### 2.4 `src/models/`

- **役割**  
  - Zod などで定義するリクエスト／レスポンス DTO。  
  - Supabase のレコード型を補強する型定義。
- **ファイル例**  
  - `user.schema.ts`, `project.schema.ts`, `task.schema.ts`

### 2.5 `src/controllers/`

- **役割**  
  - ルートから呼び出され、`services/` を経由して処理。  
  - Express の `Request`, `Response` を受け取り JSON レスポンスを返却。
- **ファイル例**  
  - `userController.ts` — ユーザー登録・ログイン／認証。  
  - `projectController.ts` — プロジェクト CRUD。  
  - `taskController.ts` — タスク／サブタスク管理。

### 2.6 `src/routes/`

- **役割**  
  - パスごとのルーターを定義し `app.ts` にマウント。  
- **ファイル例**  
  - `index.ts` — `/api` ルート以下を集約。  
  - `userRoutes.ts`, `projectRoutes.ts`, `taskRoutes.ts`

### 2.7 `src/services/`

- **役割**  
  - Supabase クライアントを直接操作し、ビジネスロジックを実装。  
  - コントローラはここを呼ぶだけにとどめる。
- **ファイル例**  
  - `userService.ts` — `supabase.auth.signUp()`, `supabase.auth.signIn()` 等。  
  - `projectService.ts` — `supabase.from('projects').select()…` 等。  
  - `taskService.ts`

### 2.8 `src/utils/`

- **役割**  
  - 共通関数（例：日付フォーマット、エラーメッセージ整形）。  
- **ファイル例**  
  - `dateUtils.ts`, `responseFormatter.ts`

### 2.9 `src/types/`

- **役割**  
  - フロント／バック両面で共有する型定義。  
- **ファイル例**  
  - `index.d.ts`, `supabase.ts`（テーブル定義の型拡張）

### 2.10 `src/app.ts` & `src/server.ts`

- **`app.ts`**  
  - Express インスタンス作成、ミドルウェア登録、ルートマウントを実装。  
- **`server.ts`**  
  - DB（Supabase）の初期化不要だが、環境チェック → `app.listen()` 実行。

---

## 3. テスト構成 (`tests/`)

```
tests/
├── unit/         ← サービス層、ユーティリティ関数の単体テスト
└── integration/  ← Supabase との疎通テスト、エンドポイント E2E テスト
```

- テストフレームワーク: Jest + Supertest  
- CI: GitHub Actions 等でプルリクエスト時に自動実行

---

## 4. Supabase 連携要件

1. **Auth**  
   - メール／パスワード認証 + JWT  
   - ログイン状態は Frontend のミドルウェアでも検証
2. **Database**  
   - スキーマ定義は Supabase SQL エディタ or `supabase/migrations` フォルダで管理  
   - テーブル: `users`, `projects`, `task_groups`, `tasks`, `subtasks`, `ai_messages`
3. **リアルタイム**  
   - 必要に応じて `supabase.channel()` でタスク更新をリアルタイム配信  
4. **ストレージ**  
   - ユーザーのプロフィール画像は Supabase Storage に保存

---

以上が **Supabase** を前提にしたバックエンドディレクトリ構造要件です。  
次ステップでは、各ディレクトリ配下の要件定義（ファイル一覧／インターフェース仕様）を詳細化していきます。```






